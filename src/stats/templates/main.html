{% extends 'base.html' %}
{% load i18n staticfiles tz stats %}
{#{% block title %}{{ block.super }}{% endblock title %}#}

{% block content %}
    <section id="main">
        <div class="wrapper">
            <div class="dominant_coal">
                {% trans 'Current Tour' %}: {{ tour.get_title }}
            </div>

            <div class="general_block">
                <div class="online_players">

                    <div class="online_allies">
                        <div class="header">
                            {% trans 'Allied Pilots' %}: {{ total_allies }}
                        </div>

                        <div class="content_table">
                            {% for op in players_allies %}
                            <a class="row" {% if op.profile_id %}href="{% url 'stats:pilot' op.profile_id op.nickname %}" {% endif %}>
                                <div class="cell">{{ op.nickname }}</div>
                            </a>
                            {% endfor %}
                        </div>

                    </div>

                    <div class="online_axis">
                        <div class="header">
                            {% trans 'Axis Pilots' %}: {{ total_axis }}
                        </div>

                        <div class="content_table">
                            {% for op in players_axis %}
                            <a class="row" {% if op.profile_id %}href="{% url 'stats:pilot' op.profile_id op.nickname %}" {% endif %}>
                                <div class="cell">{{ op.nickname }}</div>
                            </a>
                            {% endfor %}
                        </div>

                    </div>

                    <div class="online_duel">
                        <div class="header">
                            {% trans 'Duel Pilots' %}: {{ total_duel }}
                        </div>

                        <div class="content_table">
                            {% for op in players_duel %}
                            <a class="row" {% if op.profile_id %}href="{% url 'stats:pilot' op.profile_id op.nickname %}" {% endif %}>
                                <div class="cell">{{ op.nickname }}</div>
                            </a>
                            {% endfor %}
                        </div>

                    </div>
                </div>

                <div class="clearfix"></div>
            </div>

            <div class="additional_block">
                {% if NEW_TOUR_BY_MONTH %}
                <div class="tour">
                    <div class="title">
                        {% trans 'Tour' %}: {{ tour.get_title }}
                    </div>
                    <div class="tour_bar">
                        {% widthratio tour.days_passed tour.days_in_tour 100 as width %}
                        <div class="bar_progress" style="width: {{ width }}%;"></div>
                    </div>
                    <div class="tour_end">
                        {% blocktrans trimmed count days=tour.days_left %}
                        {{ days }} day left
                        {% plural %}
                        {{ days }} days left
                        {% endblocktrans %}
                    </div>
                </div>
                {% endif %}

                {% if total_active_players %}
                <div class="active_players">
                    <div class="title">
                        {% trans 'Active players' %}
                    </div>
                    <div class="total">
                        {% trans 'total' context 'tour_active' %}
                    </div>
                    <div class="total_num">
                        {{ total_active_players }}
                    </div>

                    <div class="bar_mini" style="float: right;">
                        <div class="bar">
                            <div class="bar_grid" style="width: 50%;"></div>
                            {% widthratio coal_active_players.1 total_active_players 100 as width %}
                            <div class="bar_red" style="width: {{ width }}%;"></div>
                            {% widthratio coal_active_players.2 total_active_players 100 as width %}
                            <div class="bar_blue" style="width: {{ width }}%;"></div>
                        </div>
                        <div class="bar_red_num">
                            {{ coal_active_players.1 }}
                        </div>
                        <div class="bar_gray_num">
                            {{ coal_active_players.0 }}
                        </div>
                        <div class="bar_blue_num">
                            {{ coal_active_players.2 }}
                        </div>
                    </div>

                    <div class="clearfix"></div>
                </div>
                {% endif %}

                {% if top_24 %}
                <div class="top_pilots" style="float: left;">
                    <div class="top_title">
                        {% trans 'Best pilots in the last 24 hours' context 'tour_top' %}
                    </div>
                    <div class="top_table">
                        <div class="head_row">
                            <div class="cell" style="width: 30px;">#</div>
                            <div class="cell">{% trans 'pilot nickname' context 'tour_top' %}</div>
                            <div class="cell" style="width: 30px;"></div>
                            <div class="cell">{% trans 'score' context 'tour_top' %}</div>
                        </div>
                        {% for player, score in top_24 %}
                        <a class="row" href="{{ player.get_profile_url }}">
                            <div class="cell">{{ forloop.counter }}</div>
                            <div class="cell">{{ player.nickname }}</div>
                            <div class="cell img">
                                {% include 'inline/table_coal_pref_icon.html' with coal_pref=player.coal_pref %}
                            </div>
                            <div class="cell">{{ score }}</div>
                        </a>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>

            <div class="clearfix"></div>

        </div>
    </section>
{% endblock content %}
